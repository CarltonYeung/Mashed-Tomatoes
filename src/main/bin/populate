#!/usr/bin/env python3

from commandr import command, Run
import dateutil.parser

import db
import net
import oscars
from movies import store_movie

@command('movies')
def _movie(basepath, start_year=1950, end_year=2018, limit=20):
    for year in range(start_year, end_year + 1):
        ids = net.get_top_movies(year, limit)
        for id in ids:
            store_movie(id, basepath)

@command('oscars')
def _oscars(basepath):
    for api_id, year in oscars.API_MOVIE_ID_YEARS:
        db_movie_id = store_movie(api_id, basepath)
        db.save_best_picture_winner(db_movie_id, dateutil.parser.parse(str(year)))

if __name__ == '__main__':
    Run()